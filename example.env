# CORS Configuration - Set to your frontend domain or Railway internal URL
ALLOWED_ORIGIN=https://example.com
# For Railway internal networking, use: http://n8n.railway.internal

# API Key for endpoint authentication (required)
API_KEY=your-secure-api-key-here

# Used to Authenticate & Communicate with Supabase's Edge Function
PY_API_TOKEN=XXXX

# Job Worker Token (for Supabase Edge Function → Python communication)
# Generate with: openssl rand -hex 32
# Set the same token in Supabase Dashboard → Settings → Edge Functions → Secrets
PY_API_TOKEN=your-job-worker-token-here

# Directory for saved videos (when keep=true)
DOWNLOADS_DIR=./downloads

# Directory for temporary transcription files (auto-cleanup after 1 hour)
# DEPRECATED: Will be migrated to unified cache system below
TRANSCRIPTIONS_DIR=./transcriptions

# Unified cache configuration
# Single cache directory for all temporary files (videos, audio, transcriptions, screenshots)
CACHE_DIR=./cache
# Time-to-live for cached files in hours (default: 3 hours)
CACHE_TTL_HOURS=3

# Only allow 2-3 concurrent transcriptions
MAX_CONCURRENT_TRANSCRIPTIONS = 2

# Supabase Configuration (for storing transcriptions)
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_KEY=your-service-role-secret-key-here

# yt-dlp Configuration
# Path to standalone yt-dlp binary (required for YouTube downloads)
# Download from: https://github.com/yt-dlp/yt-dlp/releases
# Note: Requires Deno runtime installed (https://deno.com/)
YTDLP_BINARY=./bin/yt-dlp

# Path to cookies.txt file for authenticated YouTube downloads
# Export from browser using "Get Cookies.txt LOCALLY" extension
# See: https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies
# WARNING: Using your account risks temporary/permanent bans
YTDLP_COOKIES_FILE=./cookies.txt

# Rate limiting to avoid YouTube bans (seconds between downloads)
# Recommended: 7-25 seconds random delay between requests
YTDLP_MIN_SLEEP=7
YTDLP_MAX_SLEEP=25
YTDLP_SLEEP_REQUESTS=1.0

# Youtube Automated Cookie Refresh (Playwright)
# For automated YouTube cookie refresh using scripts/refresh_youtube_cookies.py
# Use a throwaway Google account (ban risk!)
# See docs/Youtube-Cookies-Export.md for setup instructions
YOUTUBE_EMAIL=XXXX
YOUTUBE_PASSWORD=XXXX

# Automated cookie refresh interval (days)
# Default: 5 days - adjust based on your needs
# Set to lower value if experiencing frequent auth failures
YTDLP_COOKIE_REFRESH_DAYS=5

# =============================================================================
# Transcription Job Configuration
# =============================================================================
# Configuration for transcription jobs received from Supabase Edge Functions.
# Jobs are pushed to POST /jobs/video-audio-transcription endpoint.
# Requires: SUPABASE_URL, SUPABASE_SERVICE_KEY, and PY_API_TOKEN to be configured.

# Maximum retry attempts before marking job as failed (default: 5)
WORKER_MAX_RETRIES=5

# WhisperX model size for AI transcription (default: medium)
# Options: tiny, small, medium, large-v2, large-v3, turbo
WORKER_MODEL_SIZE=medium

# Transcription provider (default: local)
# Options: local (whisperX), openai
WORKER_PROVIDER=local

# Provider name for metadata tagging (default: yt-dlp-api)
# This appears in transcription metadata as "provider" field
PROVIDER_NAME=yt-dlp-api

# =============================================================================
# Legacy Polling Worker Configuration (DEPRECATED)
# =============================================================================
# The polling worker has been replaced by endpoint-based job processing.
# Supabase Edge Functions now push jobs to POST /jobs/video-audio-transcription
# Keep these disabled unless you need the legacy polling approach.

# Enable/disable the polling worker (default: false - use endpoint-based approach)
TRANSCRIPTION_WORKER_ENABLED=false

# Seconds between queue polls when idle (only used if polling worker enabled)
WORKER_POLL_INTERVAL=5

# Maximum jobs to dequeue per poll (only used if polling worker enabled)
WORKER_BATCH_SIZE=10

# Visibility timeout in seconds (only used if polling worker enabled)
WORKER_VT_SECONDS=1800

# Seconds to wait before first poll after startup (only used if polling worker enabled)
WORKER_STARTUP_DELAY=5